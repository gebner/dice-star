/* 
  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
  KreMLin invocation: krml -no-prefix Minimal.Main ./src/Minimal.Main.fst -skip-compilation -tmpdir ./out -I ./src -I /home/zhetao/Sources/hacl-star/specs -I /home/zhetao/Sources/hacl-star/specs/lemmas -I /home/zhetao/Sources/hacl-star/code/hash -I /home/zhetao/Sources/hacl-star/code/hkdf -I /home/zhetao/Sources/hacl-star/code/hmac -I /home/zhetao/Sources/hacl-star/code/curve25519 -I /home/zhetao/Sources/hacl-star/code/ed25519 -I /home/zhetao/Sources/hacl-star/lib -I /home/zhetao/Sources/hacl-star/providers/evercrypt -warn-error +11
  F* version: 953b2211
  KreMLin version: e324b7e6
 */

#include "Spec_Hash_PadFinish.h"

static Prims_list__Lib_IntTypes_sec_int_t____
*FStar_Seq_Base_cons__Lib_IntTypes_sec_int_t___(
  Lib_IntTypes_sec_int_t____ x,
  Prims_list__Lib_IntTypes_sec_int_t____ *s
)
{
  KRML_CHECK_SIZE(sizeof (Prims_list__Lib_IntTypes_sec_int_t____), (uint32_t)1U);
  Prims_list__Lib_IntTypes_sec_int_t____
  *buf = KRML_HOST_MALLOC(sizeof (Prims_list__Lib_IntTypes_sec_int_t____));
  buf[0U] = ((Prims_list__Lib_IntTypes_sec_int_t____){ .tag = Prims_Cons, .hd = x, .tl = s });
  return buf;
}

static Prims_list__Lib_IntTypes_sec_int_t____
*FStar_Seq_Base_create__Lib_IntTypes_sec_int_t___(Prims_int len, Lib_IntTypes_sec_int_t____ v)
{
  if (len == (krml_checked_int_t)0)
  {
    KRML_CHECK_SIZE(sizeof (Prims_list__Lib_IntTypes_sec_int_t____), (uint32_t)1U);
    Prims_list__Lib_IntTypes_sec_int_t____
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__Lib_IntTypes_sec_int_t____));
    buf[0U] = ((Prims_list__Lib_IntTypes_sec_int_t____){ .tag = Prims_Nil });
    return buf;
  }
  else
    return
      FStar_Seq_Base_cons__Lib_IntTypes_sec_int_t___(v,
        FStar_Seq_Base_create__Lib_IntTypes_sec_int_t___(Prims_op_Subtraction(len,
            (krml_checked_int_t)1),
          v));
}

static Prims_list__Lib_IntTypes_sec_int_t____
*FStar_List_Tot_Base_append__Lib_IntTypes_sec_int_t___(
  Prims_list__Lib_IntTypes_sec_int_t____ *x,
  Prims_list__Lib_IntTypes_sec_int_t____ *y
)
{
  if (x->tag == Prims_Nil)
    return y;
  else if (x->tag == Prims_Cons)
  {
    Prims_list__Lib_IntTypes_sec_int_t____ *tl1 = x->tl;
    Lib_IntTypes_sec_int_t____ a = x->hd;
    KRML_CHECK_SIZE(sizeof (Prims_list__Lib_IntTypes_sec_int_t____), (uint32_t)1U);
    Prims_list__Lib_IntTypes_sec_int_t____
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__Lib_IntTypes_sec_int_t____));
    buf[0U]
    =
      (
        (Prims_list__Lib_IntTypes_sec_int_t____){
          .tag = Prims_Cons,
          .hd = a,
          .tl = FStar_List_Tot_Base_append__Lib_IntTypes_sec_int_t___(tl1, y)
        }
      );
    return buf;
  }
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

static Prims_list__Lib_IntTypes_sec_int_t____
*FStar_Seq_Base_append__Lib_IntTypes_sec_int_t___(
  Prims_list__Lib_IntTypes_sec_int_t____ *s1,
  Prims_list__Lib_IntTypes_sec_int_t____ *s2
)
{
  return FStar_List_Tot_Base_append__Lib_IntTypes_sec_int_t___(s1, s2);
}

Prims_list__Lib_IntTypes_sec_int_t____
*FStar_Seq_Base_op_At_Bar__Lib_IntTypes_sec_int_t___(
  Prims_list__Lib_IntTypes_sec_int_t____ *s1,
  Prims_list__Lib_IntTypes_sec_int_t____ *s2
)
{
  return FStar_Seq_Base_append__Lib_IntTypes_sec_int_t___(s1, s2);
}

Prims_list__Lib_IntTypes_sec_int_t____
*Spec_Hash_PadFinish_pad(Spec_Hash_Definitions_hash_alg a, Prims_int total_len)
{
  Prims_list__Lib_IntTypes_sec_int_t____
  *firstbyte =
    FStar_Seq_Base_create__Lib_IntTypes_sec_int_t___((krml_checked_int_t)1,
      Lib_IntTypes_mk_int(Lib_IntTypes_U8, Lib_IntTypes_SEC, (krml_checked_int_t)0x80));
  Prims_list__Lib_IntTypes_sec_int_t____
  *zeros1 =
    FStar_Seq_Base_create__Lib_IntTypes_sec_int_t___(Spec_Hash_Definitions_pad0_length(a,
        total_len),
      Lib_IntTypes_mk_int(Lib_IntTypes_U8, Lib_IntTypes_SEC, (krml_checked_int_t)0));
  Prims_int total_len_bits = Prims_op_Multiply(total_len, (krml_checked_int_t)8);
  Prims_list__Lib_IntTypes_sec_int_t____ *encodedlen;
  switch (a)
  {
    case Spec_Hash_Definitions_MD5:
      {
        Lib_IntTypes_inttype sw0;
        switch (a)
        {
          case Spec_Hash_Definitions_MD5:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA1:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_224:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_256:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_384:
            {
              sw0 = Lib_IntTypes_U128;
              break;
            }
          case Spec_Hash_Definitions_SHA2_512:
            {
              sw0 = Lib_IntTypes_U128;
              break;
            }
          default:
            {
              KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
              KRML_HOST_EXIT(253U);
            }
        }
        Lib_IntTypes_inttype sw1;
        switch (a)
        {
          case Spec_Hash_Definitions_MD5:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA1:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_224:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_256:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_384:
            {
              sw1 = Lib_IntTypes_U128;
              break;
            }
          case Spec_Hash_Definitions_SHA2_512:
            {
              sw1 = Lib_IntTypes_U128;
              break;
            }
          default:
            {
              KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
              KRML_HOST_EXIT(253U);
            }
        }
        Lib_IntTypes_inttype sw;
        switch (a)
        {
          case Spec_Hash_Definitions_MD5:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA1:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_224:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_256:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_384:
            {
              sw = Lib_IntTypes_U128;
              break;
            }
          case Spec_Hash_Definitions_SHA2_512:
            {
              sw = Lib_IntTypes_U128;
              break;
            }
          default:
            {
              KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
              KRML_HOST_EXIT(253U);
            }
        }
        encodedlen =
          (Prims_list__Lib_IntTypes_sec_int_t____ *)Lib_ByteSequence_uint_to_bytes_le(sw0,
            Lib_IntTypes_SEC,
            (void *)Lib_IntTypes_secret(sw1,
              Lib_IntTypes_mk_int(sw,
                Lib_IntTypes_PUB,
                Prims_op_Multiply(total_len, (krml_checked_int_t)8))));
        break;
      }
    default:
      {
        Lib_IntTypes_inttype sw0;
        switch (a)
        {
          case Spec_Hash_Definitions_MD5:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA1:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_224:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_256:
            {
              sw0 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_384:
            {
              sw0 = Lib_IntTypes_U128;
              break;
            }
          case Spec_Hash_Definitions_SHA2_512:
            {
              sw0 = Lib_IntTypes_U128;
              break;
            }
          default:
            {
              KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
              KRML_HOST_EXIT(253U);
            }
        }
        Lib_IntTypes_inttype sw1;
        switch (a)
        {
          case Spec_Hash_Definitions_MD5:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA1:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_224:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_256:
            {
              sw1 = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_384:
            {
              sw1 = Lib_IntTypes_U128;
              break;
            }
          case Spec_Hash_Definitions_SHA2_512:
            {
              sw1 = Lib_IntTypes_U128;
              break;
            }
          default:
            {
              KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
              KRML_HOST_EXIT(253U);
            }
        }
        Lib_IntTypes_inttype sw;
        switch (a)
        {
          case Spec_Hash_Definitions_MD5:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA1:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_224:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_256:
            {
              sw = Lib_IntTypes_U64;
              break;
            }
          case Spec_Hash_Definitions_SHA2_384:
            {
              sw = Lib_IntTypes_U128;
              break;
            }
          case Spec_Hash_Definitions_SHA2_512:
            {
              sw = Lib_IntTypes_U128;
              break;
            }
          default:
            {
              KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
              KRML_HOST_EXIT(253U);
            }
        }
        encodedlen =
          (Prims_list__Lib_IntTypes_sec_int_t____ *)Lib_ByteSequence_uint_to_bytes_be(sw0,
            Lib_IntTypes_SEC,
            (void *)Lib_IntTypes_secret(sw1,
              Lib_IntTypes_mk_int(sw,
                Lib_IntTypes_PUB,
                Prims_op_Multiply(total_len, (krml_checked_int_t)8))));
      }
  }
  return
    FStar_Seq_Base_op_At_Bar__Lib_IntTypes_sec_int_t___(firstbyte,
      FStar_Seq_Base_op_At_Bar__Lib_IntTypes_sec_int_t___(zeros1, encodedlen));
}

static Prims_list__Lib_IntTypes_sec_int_t____
*FStar_List_Tot_Base_tail__Lib_IntTypes_sec_int_t___(
  Prims_list__Lib_IntTypes_sec_int_t____ *uu___1_64
)
{
  if (uu___1_64->tag == Prims_Cons)
    return uu___1_64->tl;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

static Prims_list__Lib_IntTypes_sec_int_t____
*(*FStar_List_Tot_Base_tl__Lib_IntTypes_sec_int_t___)(
  Prims_list__Lib_IntTypes_sec_int_t____ *x0
) = FStar_List_Tot_Base_tail__Lib_IntTypes_sec_int_t___;

static Prims_list__Lib_IntTypes_sec_int_t____
*FStar_Seq_Base_tl__Lib_IntTypes_sec_int_t___(Prims_list__Lib_IntTypes_sec_int_t____ *s)
{
  return FStar_List_Tot_Base_tl__Lib_IntTypes_sec_int_t___(s);
}

static Lib_IntTypes_sec_int_t____
FStar_List_Tot_Base_hd__Lib_IntTypes_sec_int_t___(
  Prims_list__Lib_IntTypes_sec_int_t____ *uu___0_39
)
{
  if (uu___0_39->tag == Prims_Cons)
    return uu___0_39->hd;
  else
  {
    KRML_HOST_EPRINTF("KreMLin abort at %s:%d\n%s\n",
      __FILE__,
      __LINE__,
      "unreachable (pattern matches are exhaustive in F*)");
    KRML_HOST_EXIT(255U);
  }
}

static Lib_IntTypes_sec_int_t____
FStar_Seq_Base_hd__Lib_IntTypes_sec_int_t___(Prims_list__Lib_IntTypes_sec_int_t____ *s)
{
  return FStar_List_Tot_Base_hd__Lib_IntTypes_sec_int_t___(s);
}

Prims_list__Lib_IntTypes_sec_int_t____
*FStar_Seq_Base_slice__Lib_IntTypes_sec_int_t___(
  Prims_list__Lib_IntTypes_sec_int_t____ *s,
  Prims_int i,
  Prims_int j
)
{
  if (Prims_op_GreaterThan(i, (krml_checked_int_t)0))
    return
      FStar_Seq_Base_slice__Lib_IntTypes_sec_int_t___(FStar_Seq_Base_tl__Lib_IntTypes_sec_int_t___(s),
        Prims_op_Subtraction(i, (krml_checked_int_t)1),
        Prims_op_Subtraction(j, (krml_checked_int_t)1));
  else if (j == (krml_checked_int_t)0)
  {
    KRML_CHECK_SIZE(sizeof (Prims_list__Lib_IntTypes_sec_int_t____), (uint32_t)1U);
    Prims_list__Lib_IntTypes_sec_int_t____
    *buf = KRML_HOST_MALLOC(sizeof (Prims_list__Lib_IntTypes_sec_int_t____));
    buf[0U] = ((Prims_list__Lib_IntTypes_sec_int_t____){ .tag = Prims_Nil });
    return buf;
  }
  else
    return
      FStar_Seq_Base_cons__Lib_IntTypes_sec_int_t___(FStar_Seq_Base_hd__Lib_IntTypes_sec_int_t___(s),
        FStar_Seq_Base_slice__Lib_IntTypes_sec_int_t___(FStar_Seq_Base_tl__Lib_IntTypes_sec_int_t___(s),
          i,
          Prims_op_Subtraction(j, (krml_checked_int_t)1)));
}

Prims_list__Lib_IntTypes_sec_int_t____
*Spec_Hash_PadFinish_finish(
  Spec_Hash_Definitions_hash_alg a,
  Prims_list__Lib_IntTypes_sec_int_t____ *hashw
)
{
  Prims_int sw0;
  switch (a)
  {
    case Spec_Hash_Definitions_MD5:
      {
        sw0 = (krml_checked_int_t)4;
        break;
      }
    case Spec_Hash_Definitions_SHA1:
      {
        sw0 = (krml_checked_int_t)5;
        break;
      }
    case Spec_Hash_Definitions_SHA2_224:
      {
        sw0 = (krml_checked_int_t)7;
        break;
      }
    case Spec_Hash_Definitions_SHA2_256:
      {
        sw0 = (krml_checked_int_t)8;
        break;
      }
    case Spec_Hash_Definitions_SHA2_384:
      {
        sw0 = (krml_checked_int_t)6;
        break;
      }
    case Spec_Hash_Definitions_SHA2_512:
      {
        sw0 = (krml_checked_int_t)8;
        break;
      }
    default:
      {
        KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
        KRML_HOST_EXIT(253U);
      }
  }
  Prims_list__Lib_IntTypes_sec_int_t____
  *hash_final_w =
    FStar_Seq_Base_slice__Lib_IntTypes_sec_int_t___(hashw,
      (krml_checked_int_t)0,
      sw0);
  Prims_int sw;
  switch (a)
  {
    case Spec_Hash_Definitions_MD5:
      {
        sw = (krml_checked_int_t)4;
        break;
      }
    case Spec_Hash_Definitions_SHA1:
      {
        sw = (krml_checked_int_t)5;
        break;
      }
    case Spec_Hash_Definitions_SHA2_224:
      {
        sw = (krml_checked_int_t)7;
        break;
      }
    case Spec_Hash_Definitions_SHA2_256:
      {
        sw = (krml_checked_int_t)8;
        break;
      }
    case Spec_Hash_Definitions_SHA2_384:
      {
        sw = (krml_checked_int_t)6;
        break;
      }
    case Spec_Hash_Definitions_SHA2_512:
      {
        sw = (krml_checked_int_t)8;
        break;
      }
    default:
      {
        KRML_HOST_EPRINTF("KreMLin incomplete match at %s:%d\n", __FILE__, __LINE__);
        KRML_HOST_EXIT(253U);
      }
  }
  return Spec_Hash_Definitions_bytes_of_words(a)(sw, hash_final_w);
}

