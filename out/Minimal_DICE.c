/* 
  This file was generated by KreMLin <https://github.com/FStarLang/kremlin>
  KreMLin invocation: krml -no-prefix Minimal.Main ../src/Minimal.Main.fst -skip-compilation -tmpdir ../out -I /home/zhetao/Sources/hacl-star/specs -I /home/zhetao/Sources/hacl-star/specs/lemmas -I /home/zhetao/Sources/hacl-star/code/hash -I /home/zhetao/Sources/hacl-star/code/hkdf -I /home/zhetao/Sources/hacl-star/code/hmac -I /home/zhetao/Sources/hacl-star/code/curve25519 -I /home/zhetao/Sources/hacl-star/code/ed25519 -I /home/zhetao/Sources/hacl-star/lib -I /home/zhetao/Sources/hacl-star/providers/evercrypt -warn-error +11
  F* version: 953b2211
  KreMLin version: e324b7e6
 */

#include "Minimal_DICE.h"

Spec_Hash_Definitions_hash_alg Minimal_DICE__DICE_ALG = Spec_Hash_Definitions_SHA2_256;

uint32_t Minimal_DICE__DICE_UDS_LENGTH = (uint32_t)(krml_checked_int_t)0x20;

uint32_t Minimal_DICE__DICE_DIGEST_LENGTH;

Lib_IntTypes_sec_int_t____ *Minimal_DICE_diceStart()
{
  Lib_IntTypes_sec_int_t____
  *uds = Minimal_DICE_get_UDS(FStar_UInt32_v(Minimal_DICE__DICE_UDS_LENGTH));
  Lib_IntTypes_sec_int_t____ *measurement = Minimal_DICE_get_measurement(Minimal_DICE__DICE_ALG);
  KRML_CHECK_SIZE(sizeof (Lib_IntTypes_sec_int_t____), Minimal_DICE__DICE_DIGEST_LENGTH);
  Lib_IntTypes_sec_int_t____ uDigest[Minimal_DICE__DICE_DIGEST_LENGTH];
  for (uint32_t _i = 0U; _i < Minimal_DICE__DICE_DIGEST_LENGTH; ++_i)
    uDigest[_i] = Lib_IntTypes_mk_int(Lib_IntTypes_U8, Lib_IntTypes_SEC, (krml_checked_int_t)0x00);
  KRML_CHECK_SIZE(sizeof (Lib_IntTypes_sec_int_t____), Minimal_DICE__DICE_DIGEST_LENGTH);
  Lib_IntTypes_sec_int_t____ rDigest[Minimal_DICE__DICE_DIGEST_LENGTH];
  for (uint32_t _i = 0U; _i < Minimal_DICE__DICE_DIGEST_LENGTH; ++_i)
    rDigest[_i] = Lib_IntTypes_mk_int(Lib_IntTypes_U8, Lib_IntTypes_SEC, (krml_checked_int_t)0x00);
  KRML_CHECK_SIZE(sizeof (Lib_IntTypes_sec_int_t____), Minimal_DICE__DICE_DIGEST_LENGTH);
  Lib_IntTypes_sec_int_t____ cdi[Minimal_DICE__DICE_DIGEST_LENGTH];
  for (uint32_t _i = 0U; _i < Minimal_DICE__DICE_DIGEST_LENGTH; ++_i)
    cdi[_i] = Lib_IntTypes_mk_int(Lib_IntTypes_U8, Lib_IntTypes_SEC, (krml_checked_int_t)0x00);
  Hacl_Hash_SHA2_hash_256(uds, Minimal_DICE__DICE_UDS_LENGTH, uDigest);
  Minimal_DICE_diceSHA256(FStar_UInt32_v(Minimal_DICE__DICE_DIGEST_LENGTH),
    measurement,
    rDigest);
  Minimal_DICE_diceSHA256_2(FStar_UInt32_v(Minimal_DICE__DICE_DIGEST_LENGTH),
    uDigest,
    FStar_UInt32_v(Minimal_DICE__DICE_DIGEST_LENGTH),
    rDigest,
    cdi);
  for (uint32_t _i = 0U; _i < Minimal_DICE__DICE_DIGEST_LENGTH; ++_i)
    uDigest[_i] = Lib_IntTypes_mk_int(Lib_IntTypes_U8, Lib_IntTypes_SEC, (krml_checked_int_t)0x00);
  for (uint32_t _i = 0U; _i < Minimal_DICE__DICE_DIGEST_LENGTH; ++_i)
    rDigest[_i] = Lib_IntTypes_mk_int(Lib_IntTypes_U8, Lib_IntTypes_SEC, (krml_checked_int_t)0x00);
  return cdi;
}

