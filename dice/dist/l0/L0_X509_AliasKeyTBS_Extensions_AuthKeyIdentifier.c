/* Automatically generated by the Kremlin tool */



#include "L0_X509_AliasKeyTBS_Extensions_AuthKeyIdentifier.h"

bool filter_aliasKeyTBS_extensions_authKeyID_extValue_payload(octet_string_t x)
{
  return x.len == (uint32_t)20U;
}

uint32_t
serialize32_aliasKeyTBS_extensions_authKeyID_extValue_payload_backwards(
  octet_string_t x,
  uint8_t *input,
  uint32_t pos
)
{
  return
    serialize32_asn1_octet_string_TLV_with_tag_backwards(x509_authKeyID_keyIdentifier_tag,
      x,
      input,
      pos);
}

uint32_t len_of_aliasKeyTBS_extensions_authKeyID_extValue_payload(octet_string_t keyID)
{
  return (uint32_t)22U;
}

uint32_t
serialize32_aliasKeyTBS_extensions_authKeyID_extValue_backwards(
  octet_string_t x,
  uint8_t *b,
  uint32_t pos
)
{
  uint32_t
  offset_data =
    serialize32_aliasKeyTBS_extensions_authKeyID_extValue_payload_backwards(x,
      b,
      pos);
  uint32_t
  offset2 =
    serialize32_asn1_length_of_type_backwards(((asn1_tag_t){ .tag = SEQUENCE }),
      offset_data,
      b,
      pos - offset_data);
  b[pos - offset_data - offset2 - (uint32_t)1U] =
    encode_asn1_tag(((asn1_tag_t){ .tag = SEQUENCE }));
  uint32_t offset1 = (uint32_t)1U;
  uint32_t offset_tag_len = offset1 + offset2;
  return offset_tag_len + offset_data;
}

uint32_t len_of_aliasKeyTBS_extensions_authKeyID_extValue()
{
  return (uint32_t)24U;
}

uint32_t
serialize32_aliasKeyTBS_extensions_authKeyID_backwards(
  aliasKeyTBS_extensions_authKeyID_t x,
  uint8_t *b,
  uint32_t pos
)
{
  K___ASN1_Base_oid_t_bool x1 = x.fst;
  octet_string_t x2 = x.snd;
  uint32_t
  offset_data = serialize32_aliasKeyTBS_extensions_authKeyID_extValue_backwards(x2, b, pos);
  uint32_t
  offset20 =
    serialize32_asn1_length_of_type_backwards(((asn1_tag_t){ .tag = OCTET_STRING }),
      offset_data,
      b,
      pos - offset_data);
  b[pos - offset_data - offset20 - (uint32_t)1U] =
    encode_asn1_tag(((asn1_tag_t){ .tag = OCTET_STRING }));
  uint32_t offset10 = (uint32_t)1U;
  uint32_t offset_tag_len = offset10 + offset20;
  uint32_t offset21 = offset_tag_len + offset_data;
  oid_t x11 = x1.fst;
  bool x21 = x1.snd;
  uint32_t offset210 = serialize32_asn1_boolean_TLV_backwards(x21, b, pos - offset21);
  uint32_t offset11 = serialize32_asn1_oid_TLV_backwards(x11, b, pos - offset21 - offset210);
  uint32_t offset12 = offset11 + offset210;
  uint32_t offset_data0 = offset12 + offset21;
  uint32_t
  offset2 =
    serialize32_asn1_length_of_type_backwards(((asn1_tag_t){ .tag = SEQUENCE }),
      offset_data0,
      b,
      pos - offset_data0);
  b[pos - offset_data0 - offset2 - (uint32_t)1U] =
    encode_asn1_tag(((asn1_tag_t){ .tag = SEQUENCE }));
  uint32_t offset1 = (uint32_t)1U;
  uint32_t offset_tag_len0 = offset1 + offset2;
  return offset_tag_len0 + offset_data0;
}

aliasKeyTBS_extensions_authKeyID_t
x509_get_aliasKeyTBS_extensions_authKeyID(bool criticality, octet_string_t keyID)
{
  octet_string_t extValue_payload = keyID;
  octet_string_t extValue = extValue_payload;
  return
    (
      (aliasKeyTBS_extensions_authKeyID_t){
        .fst = { .fst = OID_AUTHORITY_KEY_IDENTIFIER, .snd = criticality },
        .snd = extValue
      }
    );
}

